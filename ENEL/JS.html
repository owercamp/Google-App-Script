<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"
  integrity="sha384-oBqDVmMz9ATKxIep9tiCxS/Z9fNfEXiDAYTujMAeBAsjFuCZSmKbSSUnQlmh/jp3" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.min.js"
  integrity="sha384-mQ93GR66B00ZXjt0YO5KlohRA5SY2XofN4zfuZxLkoj1gXtW8ANNCe9d5Y3eG5eD" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.3/jquery.min.js"
  integrity="sha512-STof4xm1wgkfm7heWqFJVn58Hm3EtS31XFaagaa8VMReCXAkQnJZ+jEy8PCC/iT18dFy95WcExNHFTqLyp72eQ=="
  crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script src="https://cdn.datatables.net/v/dt/dt-1.13.4/b-2.3.6/r-2.4.1/datatables.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/sweetalert2/11.7.3/sweetalert2.min.js"
  integrity="sha512-eN8dd/MGUx/RgM4HS5vCfebsBxvQB2yI0OS5rfmqfTo8NIseU+FenpNoa64REdgFftTY4tm0w8VMj5oJ8t+ncQ=="
  crossorigin="anonymous" referrerpolicy="no-referrer"></script>

<script>
  window.addEventListener("load", general(""));
  /*** instanciaciÃ³n de los DataTables ***/
  let tbl_general = $("#tbl_data").DataTable({
    language: {
      "url": "//cdn.datatables.net/plug-ins/1.10.19/i18n/Spanish.json"
    },
    columnDefs: [
      {
        className: "dt-center", targets: "_all"
      }
    ],
    responsive: true,
    pagingType: "full_numbers"
  });

  function firstLetter(info) {
    let letter = info.split(" ");
    let wordsConverted = letter.map(letter => letter.charAt(0).toUpperCase() + letter.slice(1).toLowerCase());
    let letterConverted = wordsConverted.join(" ");

    return letterConverted;
  }

  function general(data) {
    let generalInfo = google.script.run.withSuccessHandler(element => {
      let row = JSON.parse(element);
      let insertRow = [];
      if (data) {
        tbl_general.clear().draw();
      }
      row.map(register => {
        insertRow.push({
          0: firstLetter(register[4]),
          1: register[5],
          2: register[24],
          3: register[25],
          4: register[26]
        })
      });
      tbl_general.rows.add(insertRow).draw();
    })
      .withFailureHandler(error => {
        console.log(error);
      })
    if (data) {
      generalInfo.getGeneral(data);
    } else {
      generalInfo.getGeneral();
    }
  }


</script>